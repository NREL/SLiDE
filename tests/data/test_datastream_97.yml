Path: ["data"]

CSVInput:
    - name: test_datastream_97.csv
      descriptor: 1997
    - name: test_datastream_98.csv
      descriptor: 1998

XLSXInput:
    sheet: Sheet1
    range: A3:AI55
    name:
        - coal_CO2_by_state_2013.xlsx
        - commercial_CO2_by_state_2013.xlsx
    descriptor:
        - col
        - com

Describe:
    col: year

Rename:
    - from: [missing, missing_2]
      to:   label
    - from: Amount
      to:   value

Group:
    file:   regions.csv
    from:   from
    to:     to
    input:  label
    output: region

Order:
    - {col: label,  type: String}
    - {col: region, type: String}
    # - {col: year,   type: Int}
    - {col: value,  type: Int}
    # - {col: units,  type: String}

Map:
    file:     sgf.csv
    from:     from
    to:       to
    input:    label
    output:   label

Map2:
  - file:   sgf.csv
    from:   sgf
    to:     [units, desc, code]
    input:  label
    output: [units, desc, label]


Replace:
  - col:  type
    from: [C, M]
    to:   [csa, cbsa]
  - col:  metro_or_micro
    from:
      - Micropolitan Statistical Area
      - Metropolitan Statistical Area
    to:
      - mic
      - met
  - col: central_or_outlying
    from:
      - Central
      - Outlying
    to:
      - cent
      - out