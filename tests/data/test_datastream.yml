Path: ["data"]

CSVInput:
    name: test_datastream.csv
    descriptor: test

XLSXInput:
    name:   test_datastream.xlsx
    sheet:
      - 1999
      - 2000
    range:  A7:J14
    descriptor:
      - 1999
      - 2000

Rename:
    - from: IOCode
      to:   from_industry_code
    - from: Name
      to:   from_industry_desc

Map:
    - file:   bea_all.csv
      from:   desc
      to:     code
      input:  from_industry_desc
      output: from_industry_code
    - file:   bea_all.csv
      from:   desc
      to:     code
      input:  to_industry_desc
      output: to_industry_code

Melt:
    on:   from_industry_desc
    var:  to_industry_desc
    val:  value
    type: Any

Melt:
    on:   from_industry_desc
    var:  to_industry_desc
    val:  value
    type: Any

Add:
    col:  units
    val:  millions of us dollars (USD)

Replace:
    col:  value
    from: ...
    to:   "0"