Path: [data]

CSVInput:
    name: test_datastream.csv
    descriptor: 2020

# Order:
#     - {col: year,       type: Int}
#     # - {col: from_code, type: String}
#     # - {col: from_desc, type: String}
#     - {col: from_aggr,  type: String}
#     # - {col: to_code,   type: String}
#     # - {col: to_desc,   type: String}
#     - {col: to_aggr,    type: String}
#     - {col: value,      type: Int}
#     - {col: units,      type: String}
    
Rename:
  - from: IOCode
    to:   input_code
  - from: Name
    to:   input_desc

Group:
  file:   [parse, regions.csv]
  from:   from
  to:     to
  input:  input_code
  output: region

Match:
  on:     \((?<input_code>.*)\)
  input:  input_code
  output: input_code

Melt:
  on:  [input_code, region]
  var: year
  val: value

Map:
    file:   [parse, bea.csv]
    from:   bea_code
    to:     [bea_desc, bea_windc]
    input:  input_code
    output: [input_desc, input_windc]

Add:
  col:  units
  val:  USD

Replace:
  col:  value
  from: missing
  to:   0

Drop:
  - col: linenum
    val: all
    operation: "=="
  - col: value
    val: 0
    operation: "<"