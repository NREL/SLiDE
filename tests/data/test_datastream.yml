Path: ["data"]

CSVInput:
    name: test_datastream.csv
    descriptor: 1997

XLSXInput:
    name:   test_datastream.xlsx
    sheet:
      - 1999
      - 2000
    range:  B7:J14
    descriptor:
      - 1999
      - 2000

Describe:
    col:  year

Order:
    - {col: year,       type: Int}
    # - {col: from_code, type: String}
    # - {col: from_desc, type: String}
    - {col: from_aggr,  type: String}
    # - {col: to_code,   type: String}
    # - {col: to_desc,   type: String}
    - {col: to_aggr,    type: String}
    - {col: value,      type: Int}
    - {col: units,      type: String}
    
Rename:
    - from: IOCode
      to:   from_code
    - from: Name
      to:   from_desc

Melt:
    on:
      - from_code
      - from_desc
    var:  to_desc
    val:  value
    type: Any

Map:
    file:   regions.csv
    from:   from
    to:     to
    input:  region
    output: region

Join:
    - file:   bea_all.csv
      on:     from_desc
      prefix: from
    - file:   bea_all.csv
      on:     to_desc
      prefix: to

Add:
    - col:  region
      val:  Colorado
    - col:  units
      val:  millions of us dollars (USD)

Replace:
    - col:  value
      from: ...
      to:   0
    - col:  value
      from: missing
      to:   0