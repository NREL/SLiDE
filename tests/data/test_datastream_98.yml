Path: ["data"]

CSVInput:
    name: test_datastream_98.csv
    descriptor: 1998

Describe:
    col:  year

Order:
    - {col: label,  type: String}
    - {col: region, type: String}
    # - {col: year,   type: Int}
    - {col: value,  type: Int}
    # - {col: units,  type: String}

Rename:
    - from: Column1
      to:   label
    - from: Amount
      to:   value

Melt:
    on:   label
    var:  region
    val:  value
    type: Any

Map:
    - file:     sgf.csv
      from:     from
      to:       to
      input:    label
      output:   label
    - file:     regions.csv
      from:     from
      to:       to
      input:    region
      output:   region

Add:
    col:  units
    val:  millions of us dollars (USD)