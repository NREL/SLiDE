Path: [dev, windc_1.0, 7_sectordisagg_int]

DataInput:
  - {descriptor: supply, name: supply_det.csv, col: [yr,g,s,units,value]}
  - {descriptor: use,    name: use_det.csv,    col: [yr,g,s,units,value]}
  - {descriptor: a0,    name: a0.csv,   col: [yr,g,value]}
  - {descriptor: fd0,   name: fd0.csv,  col: [yr,g,fd,value]}
  - {descriptor: fs0,   name: fs0.csv,  col: [yr,g,value]}
  - {descriptor: id0,   name: id0.csv,  col: [yr,g,s,value]}
  - {descriptor: m0,    name: m0.csv,   col: [yr,g,value]}
  - {descriptor: va0,   name: va0.csv,  col: [yr,va,s,value]}
  - {descriptor: x0,    name: x0.csv,   col: [yr,g,value]}
  - {descriptor: y0,    name: y0.csv,   col: [yr,g,value]}
  - {descriptor: ys0,   name: ys0.csv,  col: [yr,s,g,value]}
  - {descriptor: share, name: share.csv, col: [yr,disagg,summary,value]}

# Deselect:
#   col: units
#   operation: "=="

Add:
  col: units
  val: millions of us dollars (USD)

Map:
  - file:   [standardize, _units.csv]
    from:   from
    to:     [to, factor, units_out]
    input:  units
    output: [units, factor, units_out]
    kind:   left

Replace:
  - {col: g, from: titlecase, to: lowercase}
  - {col: s, from: titlecase, to: lowercase}

Operate:
  operation: "*"
  from:   units
  to:     units_out
  input:  [value, factor]
  output: value