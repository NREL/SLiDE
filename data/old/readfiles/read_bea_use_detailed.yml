path_in:  datasources/BEA_2007_2012
file_out: bea_use_io_detailed.csv
description: BEA IO Use Table (Detailed) -- https://www.bea.gov/industry/input-output-accounts-data

file_in:
    name:     Use_SUT_Framework_2007_2012_DET.xlsx
    sheet:
        - 2007
        - 2012
    range:    B6:PL420

# OUTPUT COLUMNS -- ORDERED list of output columns and value types.
col_out:
    - from_industry:      string
    - from_industry_desc: string
    - to_industry:        string
    - to_industry_desc:   string
    - year:               int
    - value:              float
    - units:              string

# RENAME -- Columns 'from' -> 'to'.
renaming:
    from:   Commodity Description
    to:     from_industry_desc

# MELT -- Normalize the dataframe by 'melting' columns into rows.
# This will lengthen the dataframe by duplicating values in the column 'on'
# into new rows. This will define two new columns.
#   (1) 'var' (of 'type') with header names from the original dataframe.
#   (2) 'val' with column values from the original dataframe.
melting:
    on:     from_industry_desc
    var:    to_industry
    val:    value
    type:   string

# SET -- Define a column 'col' and set all elements to the value 'val'.
setting:
    col:    units
    val:    millions of us dollars (USD)

# REPLACE -- Values 'from' in the column 'col' with values 'to'.
replacing:
    col:    value
    from:   missing
    to:     0

# MAP -- Define an 'output' column containing values based on those in an
# 'input' column. The mapping columns 'from' -> 'to' are contained in a
# .csv 'file' in the core_maps directory. The columns 'input' and 'from'
# should contain the same values, as should 'output' and 'to'.
mapping:
    - file:     bea_all_detailed
      from:     description
      to:       from
      input:    from_industry_desc
      output:   from_industry
    - file:     bea_all_detailed
      from:     from
      to:       description
      input:    to_industry
      output:   to_industry_desc

appending:
    col:    year
    val:    sheet