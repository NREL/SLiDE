Path:  ["..", "data", "datasources", "CFS"]

CSVInput:
  name:  cfs_2012_pumf_csv.txt
  descriptor: cfs

Order:
  - {col: shipmt_id,                type: Int}
  - {col: orig_state,               type: String}
  - {col: orig_ma,                  type: Int}
#  - {col: orig_cfs,                 type: String}
  - {col: dest_state,               type: String}
  - {col: dest_ma,                  type: Int}
#  - {col: dest_cfs,                 type: String}
  - {col: quarter,                  type: Int}
  - {col: naics,                    type: String}
  - {col: sctg,                     type: String}
  - {col: mode,                     type: Int}
  # - {col: shipmt_value,             type: Int}
  # - {col: shipmt_wght,              type: Int}
  # - {col: shipmt_dist_gc,           type: Int}
  # - {col: shipmt_dist_routed,       type: Int}
  # - {col: temp_cntl_yn,             type: Bool}
  # - {col: export_yn,                type: Bool}
  # - {col: export_cntry,             type: String}
  # - {col: hazmat,                   type: String}
  # - {col: wgt_factor,               type: Float64}
  # - {col: shipmt_value_units,       type: String}
  # - {col: shipmt_wght_units,        type: String}
  # - {col: shipmt_dist_gc_units,     type: String}
  # - {col: shipmt_dist_routed_units, type: String}

Rename:
  from: upper
  to:   lower

# Map:
#   file:   std/regions.csv
#   from:   from
#   to:     to
#   input:
#     - export_cntry
#     - orig_state
#     - dest_state
#   output:
#     - export_cntry
#     - orig_state
#     - dest_state

Replace:
  - col:  temp_cntl_yn
    from: [Y, N]
    to:   [true, false]
  - col:  export_yn
    from: [Y, N]
    to:   [true, false]
  - col:  export_cntry
    from: "N"
    to:   ""

Add:
  - col: shipmt_value_units
    val: us dollars (USD)
  - col: shipmt_wght_units
    val: weight of shipment in pounds
  - col: shipmt_dist_gc_units
    val: great circle distance in miles
  - col: shipmt_dist_routed_units
    val: routed distance in miles