Path:  ["..", "data", "datasources", "PCE"]

CSVInput:
  - name:  SAEXP1_1997_2017_ALL_AREAS_.csv
    descriptor: SAEXP1
  - name: SAEXP2_1997_2017_ALL_AREAS_.csv
    descriptor: SAEXP2

Order:
  - {col: year,          type: Int}
  - {col: region,        type: String}
  - {col: componentname, type: String}
  - {col: industryclass, type: String}
  - {col: label,         type: String}
  - {col: units,         type: String}
  - {col: value,         type: Float64}

Rename:
  - from: GeoName
    to:   region
  - from: TableName
    to:   table
  - from: Unit
    to:   units
  - from: Description
    to:   label
  - from: ComponentName
    to:   componentname
  - from: IndustryClassification
    to:   industryclass

Melt:
  on: [GeoFIPS, region, Region, table, componentname, units, Line, industryclass, label]
  var: year
  val: value
  type: Any

Map:
  - file:   regions.csv
    from:   from
    to:     to
    input:  region
    output: region
  - file:   windc/gams/map_pce.csv
    from:   from
    to:     to
    input:  label
    output: label
  - file:   units.csv
    from:   from
    to:     to
    input:  units
    output: units

Drop:
  - col: value
    val: missing
    operation: "=="
  # - col: componentname
  #   val: Per capita personal consumption expenditures (PCE) by state
  #   operation: "=="