Path: ["..", "data", "datasources", "SGF"]

XLSXInput:
  name:  97states.xlsx
  sheet: 97stspr
  range: A4:D2759
  descriptor: 1997

Describe:
  col: year

Order:
  - {col: year,  type: Int}
  - {col: state, type: String}
  - {col: label, type: String}
  - {col: units, type: String}
  - {col: value, type: Float64}

Rename:
  - from: missing
    to:   label
  - from: Amount
    to:   value

Group:
    file:   std/regions.csv
    from:   from
    to:     to
    input:  label
    output: state

# Map:
#   file:   std/sgf.csv
#   from:   from_sgf
#   to:     [units, to_sgf, code]
#   input:  label
#   output: [units, desc, label]

# Map2:
#   file: std/sgf.csv
#   from: sgf_from
#   to:   [to_sgf, sgf_windc, units]
#   input: label
#   output: [sgf_windc, units]

Drop:
  col: label
  val: missing
  operation: "=="