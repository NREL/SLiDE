Path: ["..", "data", "datasources", "SGF"]

XLSXInput:
  name:  98states.xlsx
  sheet: 98STABS
  range: A4:AZ56
  descriptor: 1998

Describe:
  col: year

Order:
  - {col: year,  type: Int}
  - {col: state, type: String}
  - {col: label, type: String}
  - {col: units, type: String}
  - {col: value, type: Float64}

Rename:
  from: missing
  to:   label

Melt:
  on:  label
  var: state
  val: value
  type: Int
  
Map:
  - file:   sgf.csv
    from:   sgf
    to:     [units, desc, code]
    input:  label
    output: [units, desc, label]
  - file:   regions.csv
    from:   from
    to:     to
    input:  state
    output: state

Drop:
  col: label
  val: missing
  operation: "=="