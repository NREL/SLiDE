# Autogenerated from generate_yaml.xlsx
Editable: true

PathIn:  [data, datasources, USGS]
PathOut: [data, experiment, usgs_dict_split.csv]

XLSXInput:
  name:  usco2015v2.0.xlsx
  range: A1:B142
  sheet: DataDictionary
  descriptor: data

Order:
  - {col: code,        type: String}
  - {col: sector_code, type: String}
  - {col: source_code, type: String}
# - {col: desc,        type: String}
  - {col: sector_desc, type: String}
  - {col: source_desc, type: String}
  - {col: salinity,    type: String}
  - {col: units,       type: String}
  - {col: notes,       type: String}

Rename:
  - {from: Column Tag, to: code}
  - {from: Attribute,  to: desc}
  - {from: Attribute,  to: desc}

Match:
  - on:     (?<sector_code>.*)-(?<source_code>.*)
    input:  code
    output: [sector_code, source_code]
  - on:     (?<sector_desc>Total|.*?(?=,)),*\s(?<source_desc>.*), in (?<units>.*)
    input:  desc
    output: [sector_desc, source_desc, units]
  - on:     (?<source_desc>.*), (?<salinity>.*)
    input:  source_desc
    output: [source_desc, salinity]
  - on:     (?<units>.*?(?=\[)|.*$)(?<notes>.*)
    input:  units
    output: [units, notes]

Map:
  - file:   [parse, units.csv]
    from:   from
    to:     to
    input:  units
    output: units
    kind:   left

Replace:
  - col: [salinity, notes]
    from: ""
    to:   missing
  - col: [sector_desc, source_desc, salinity]
    from: lower
    to:   uppercasefirst

Drop:
  - col: Column Tag
    val: [STATE, STATEFIPS, COUNTY, COUNTYFIPS, FIPS, YEAR]
    operation: "=="
