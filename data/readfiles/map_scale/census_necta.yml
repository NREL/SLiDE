# Autogenerated from generate_yaml.xlsx
Editable: true

Path: [.., data, mapsources, Census, NECTA]

PathOut: [.., data, coremaps, scale, census_necta.csv]

XLSXInput:
# - name: list3_Sep_2018.xlsx
#   sheet: List 3
#   range: A3:K891
#   descriptor: 2018-09
  - name: list3.xlsx
    sheet: List 3
    range: A3:K876
    descriptor: 2013-02

Describe:
  col: updated

Order:
# - {col: updated,    type: Date}
  - {col: state_code,    type: Any}
  - {col: county_code,   type: Any}
  - {col: cousub_code,   type: Any}
  - {col: cnecta_code,   type: Any}
  - {col: necta_code,    type: Any}
  - {col: nectadiv_code, type: Any}
  - {col: cnecta_desc,   type: Any}
  - {col: necta_desc,    type: Any}
  - {col: nectadiv_desc, type: Any}
  - {col: place_desc,    type: Any}
  - {col: nmemi,         type: Any}
  - {col: nectapci,      type: Any}

Rename:
  - {from: FIPS State Code,                               to: state_code}
  - {from: FIPS County Code,                              to: county_code}
  - {from: NECTA Code,                                    to: necta_code}
  - {from: NECTA Title,                                   to: necta_desc}
  - {from: NECTA Division Code,                           to: nectadiv_code}
  - {from: NECTA Division Title,                          to: nectadiv_desc}
  - {from: Combined NECTA Code,                           to: cnecta_code}
  - {from: Combined NECTA Title,                          to: cnecta_desc}
  - {from: [FIPS MCD Code, FIPS County Subdivision Code], to: cousub_code}
  - {from: City or Town Name,                             to: place_desc}
  - {from: Metropolitan/Micropolitan NECTA,               to: nmemi}

Match:
  - on:     "(?<place_desc>.*) town"
    input:  place_desc
    output: place_desc
  - on:     "(?<place_desc>.*) city"
    input:  place_desc
    output: place_desc

Map2:
  file:   [scale, census_necta_cities.csv]
  from:   [state_code, necta_code, place_desc]
  to:     [nectapci]
  input:  [state_code, necta_code, place_desc]
  output: [nectapci]

Replace:
  - col:  nmemi
    from: [Metropolitan NECTA, Micropolitan NECTA]
    to:   [1, 2]
  - col:  nectapci
    from: missing
    to:   false
