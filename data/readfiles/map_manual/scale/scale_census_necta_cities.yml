Path: ["..", "data", "mapsources", "Census", "NECTA_Cities"]
PathOut: ["..", "data", "coremaps", "scale", "census_necta_cities.csv"]

Source: "https://www.census.gov/geographies/reference-files/time-series/demo/metro-micro/delineation-files.html"

XLSXInput:
  - name:  list4_Sep_2018.xlsx
    sheet: List 4
    range: A3:F62
    descriptor: 2018-09
  - name:  list4.xlsx
    sheet: List4
    range: A3:F61
    descriptor: 2013-02

Describe:
  col: updated

Order:
  # - {col: updated,    type: Date}
  - {col: state_code, type: Any}
  - {col: necta_code, type: Any}
  - {col: place_code, type: Any}
  - {col: necta_desc, type: Any}
  - {col: place_desc, type: Any}
  - {col: nmemi,      type: Any}
  - {col: nectapci,   type: Bool}

Rename:
  - {from: FIPS State Code,                 to: state_code}
  - {from: NECTA Code,                      to: necta_code}
  - {from: NECTA Title,                     to: necta_desc}
  - {from: FIPS Place Code,                 to: place_code}
  - {from: Principal City Name,             to: place_desc}
  - {from: Metropolitan/Micropolitan NECTA, to: nmemi}

Replace:
  col:  nmemi
  from: [Metropolitan NECTA, Micropolitan NECTA]
  to:   [1, 2]

Add:
  col: nectapci
  val: true

Match:
  - on: "(?<place_desc>.*) town"
    input:  place_desc
    output: place_desc
  - on: "(?<place_desc>.*) city"
    input:  place_desc
    output: place_desc