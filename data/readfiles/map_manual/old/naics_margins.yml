Path:  ["..", "data", "datasources", "BEA", "IO"]
# PathOut: ["..", "data", "coremaps", "temp", "naics_c.csv"]

XLSXInput:
  name:  Margins_Before_Redefinitions_2007_2012_SUM.xlsx
  sheet: 2007
  range: "A5:D61845"
  descriptor: c

# Order:
#   - {col: a_code, type: String}
#   - {col: b_code, type: String}
#   - {col: c_code, type: String}
#   - {col: c_desc, type: String}
# #   - {col: b_aggr, type: String}

Rename:
  - from: Industry Code
    to:   ind_code
  - from: Industry Description
    to:   ind_desc
  - from: Commodity Code
    to:   com_code
  - from: Commodity Description
    to:   com_desc

# Group:
#   file:   "temp/naics_b.csv"
#   from:   b_desc
#   to:     b_code
#   input:  c_code
#   output: b_code

Map:
  file:   bea_all_detailed.csv
  from:   code
  to:     desc
  input:  code
  output: desc

# Join:
#   file:   bea_all.csv
#   on:     b_code
#   prefix: b