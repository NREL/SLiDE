Path:  ["..", "data", "datasources", "BEA", "IO"]
PathOut: ["..", "data", "coremaps", "temp", "naics_d.csv"]

XLSXInput:
  name:  Margins_Before_Redefinitions_2007_2012_SUM.xlsx
  sheet: NAICS Codes
  range: "D5:G1025"
  descriptor: d

Order:
  - {col: a_code, type: String}
  - {col: b_code, type: String}
  - {col: c_code, type: String}
  - {col: d_code, type: String}
  - {col: d_desc, type: String}
#   - {col: b_aggr, type: String}

Rename:
  - from: Detail
    to:   d_code
  - from: missing
    to:   d_desc
  - from: Related 2012 NAICS Codes
    to:   d_code2

Group:
  file:   "temp/naics_c.csv"
  from:   c_desc
  to:     c_code
  input:  d_code
  output: c_code

Map:
  - file:   "temp/naics_c.csv"
    from:   c_code
    to:     b_code
    input:  c_code
    output: b_code
  - file:   "temp/naics_b.csv"
    from:   b_code
    to:     a_code
    input:  b_code
    output: a_code