# Autogenerated from generate_yaml.xlsx
Complete: true

Path: ["..", "data", "datasources", "SEDS"]

PathOut: ["..", "data", "output", "seds.csv"]

CSVInput:
  name: Complete_SEDS_update.csv
  descriptor: seds

Order:
  - {col: year,        type: Int}
  - {col: state,       type: String}
  - {col: msn,         type: String}
  - {col: source_code, type: String}
  - {col: sector_code, type: String}
  - {col: units,       type: String}
  - {col: value,       type: String}

Rename:
  - {from: upper,     to: lower}
  - {from: statecode, to: state}
  - {from: data,      to: value}

Match:
  on:     (?<source_code>.{2})(?<sector_code>.{2})(?<units>.)
  input:  msn
  output: ["source_code", "sector_code", "units"]

Map2:
  - file:   [parse, regions.csv]
    from:   from
    to:     to
    input:  state
    output: state
# - file:   [parse, units.csv]
#   from:   from
#   to:     to
#   input:  units
#   output: units

Replace:
  col:  value
  from: missing
  to:   0

Drop:
  - col: "Data_Status"
    val: all
    operation: "=="
# - col: value
#   val: missing
#   operation: "=="
