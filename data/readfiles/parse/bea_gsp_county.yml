# Autogenerated from generate_yaml.xlsx
Editable: true

Path:  [.., data, datasources, BEA, GDP, County]

PathOut: [.., data, output, gsp_county.csv]

XLSXInput:
  name:  GCP_Release_1.xlsx
  sheet: Current Dollar GDP
  range: A4:I12456
  descriptor: gsp_county

Order:
  - {col: year,          type: Int}
  - {col: state_code,    type: String}
  - {col: region_code,   type: String}
  - {col: state_desc,    type: String}
  - {col: region_desc,   type: String}
  - {col: industry_desc, type: String}
  - {col: units,         type: String}
  - {col: value,         type: Float64}

Rename:
  - {from: missing,   to: region_code}
  - {from: missing_1, to: region_desc}
  - {from: missing_2, to: state_desc}
  - {from: missing_4, to: industry_desc}

Match:
  on:     (?<state_code>.{2})(?<region_code>.{3})
  input:  region_code
  output: [state_code, region_code]

Melt:
  on:  [state_code, region_code, state_desc, region_desc, industry_desc]
  var: year
  val: value

Add:
  col: units
  val: thousands of us dollars (USD)

Map:
  - file:   [parse, regions.csv]
    from:   from
    to:     to
    input:  state_desc
    output: state_desc

Replace:
  - col:  value
    from: (D)
    to:   0

Drop:
  col: missing_3
  val: all
  operation: "=="
