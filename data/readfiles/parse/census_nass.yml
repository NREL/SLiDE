# Autogenerated from generate_yaml.xlsx
Editable: true

Path: [data, datasources, NASS]

PathOut: [data, output, nass.csv]

CSVInput:
  name: agcensus_2012_sales_redownload.csv
  descriptor: 2012

Order:
  - {col: yr,    type: Int}
# !!!! Should be r, not sr, since "us" not included
# - {col: sr,    type: String}
  - {col: r,     type: String}
  - {col: n,     type: String}
  - {col: units, type: Any}
  - {col: value, type: Any}
# - {col: units_0, type: String}
# - {col: value_0, type: Any}
# - {col: factor,  type: Any}

Rename:
  - {from: upper,           to: lower}
  - {from: year,            to: yr}
  - {from: state,           to: r}
  - {from: domain category, to: n}

Match:
  on:     \((?<n>.*)\)
  input:  n
  output: n

Add:
  col: units
  val: us dollars (USD)

Map:
# - file:   [parse, naics.csv]
#   from:   naics_code
#   to:     naics_level
#   input:  n
#   output: n_level
  - file:   [parse, regions.csv]
    from:   from
    to:     to
    input:  r
    output: r
  - file:   [parse, units.csv]
    from:   from
    to:     [to, factor, units_factor]
    input:  units
    output: [units, factor, units_factor]

Replace:
  col:  value
  from: [(D), (H), (L)]
  to:   0

Drop:
  col: [Program, Period, Week Ending, Geo Level, Ag District, Ag District Code, County, County ANSI, Zip Code, Region, Watershed, watershed_code, Commodity, Data Item, Domain, CV (%)]
  val: all
  operation: "=="

Operate:
  operation: "*"
  axis:   col
  from:   units
  to:     units_factor
  input:  [value, factor]
  output: value
