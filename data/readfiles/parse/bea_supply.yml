# Autogenerated from generate_yaml.xlsx
Complete: true

Path: [.., data, datasources, BEA, IO]

PathOut: [.., data, output, bea_supply.csv]

XLSXInput:
  name:  Supply_1997-2017_SUM.xlsx
  range: A7:CG81
  sheet:      [1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017]
  descriptor: [1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017]

Describe:
  col: year

Order:
  - {col: year,             type: Int}
  - {col: input_bea_code,   type: String}
  - {col: input_bea_windc,  type: String}
  - {col: output_bea_code,  type: String}
  - {col: output_bea_windc, type: String}
  - {col: units,            type: String}
  - {col: value,            type: Int}

Rename:
  - {from: IOCode, to: input_bea_code}
  - {from: Name,   to: input_bea_desc}

Melt:
  on:  [input_bea_code, input_bea_desc]
  var: output_bea_desc
  val: value

Add:
  col: units
  val: millions of us dollars (USD)

Map2:
  - file:   [parse, bea_summary.csv]
    from:   bea_desc
    to:     [bea_code, bea_windc]
    input:  output_bea_desc
    output: [output_bea_code, output_bea_windc]
  - file:   [parse, bea_summary.csv]
    from:   [bea_code, bea_desc]
    to:     bea_windc
    input:  [input_bea_code, input_bea_desc]
    output: input_bea_windc

Replace:
  col:  value
  from: "..."
  to:   0
