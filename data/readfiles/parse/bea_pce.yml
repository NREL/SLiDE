# Autogenerated from generate_yaml.xlsx
Complete: true

Path: ["..", "data", "datasources", "PCE"]

PathOut: ["..", "data", "output", "pce.csv"]

CSVInput:
  - {name: SAEXP1_1997_2017_ALL_AREAS_.csv, descriptor: SAEXP1}
  - {name: SAEXP2_1997_2017_ALL_AREAS_.csv, descriptor: SAEXP2}

Order:
  - {col: year,          type: Int}
  - {col: region_code,   type: String}
  - {col: region_desc,   type: String}
# - {col: component,     type: String}
  - {col: industry_desc, type: String}
  - {col: units,         type: String}
  - {col: value,         type: Float64}

Rename:
  - {from: GeoFIPS,       to: region_code}
  - {from: GeoName,       to: region_desc}
  - {from: Unit,          to: units}
  - {from: Description,   to: industry_desc}
  - {from: ComponentName, to: component}

Match:
  - on:     \"(?<region_code>.{2})000\"
    input:  region_code
    output: region_code

Melt:
  on:  [region_code, region_desc, component, units, industry_desc]
  var: year
  val: value

Map2:
  - file:   [windc, gams, map_pce.csv]
    from:   from
    to:     to
    input:  industry_desc
    output: industry_desc
  - file:   [parse, regions.csv]
    from:   from
    to:     to
    input:  region_desc
    output: region_desc
# - file:   [parse, units.csv]
#   from:   from
#   to:     to
#   input:  units
#   output: units

Drop:
  - col: [Region, TableName, Line, IndustryClassification]
    val: all
    operation: "=="
# - col: value
#   val: missing
#   operation: "=="
  - col: component
    val: Per capita personal consumption expenditures (PCE) by state
    operation: "=="
