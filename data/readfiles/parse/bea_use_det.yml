# Autogenerated from generate_yaml.xlsx
# !!!! missing AND 0 values. Should we drop missing or make 0?
Editable: true

Path: [data, datasources, BEA_2007_2012]

PathOut: [data, output, use_det.csv]

XLSXInput:
  name:  Use_SUT_Framework_2007_2012_DET.xlsx
  range: A6:PL420
  sheet:      [2007, 2012]
  descriptor: [2007, 2012]

Describe:
  col: yr

Order:
  - {col: yr,         type: Int}
# - {col: input_bea,  type: String}
  - {col: i,          type: String}
# - {col: output_bea, type: String}
  - {col: j,          type: String}
  - {col: units,      type: String}
  - {col: value,      type: Float64}

Rename:
  - {from: Code,                  to: input_bea}
  - {from: Commodity Description, to: input_desc}

Melt:
  on:  [input_bea, input_desc]
  var: output_bea
  val: value

Add:
  col: units
  val: millions of us dollars (USD)

Map:
  - file:   [parse, bea_detail.csv]
    from:   bea_code
    to:     [bea_desc, bea_windc]
    input:  output_bea
    output: [output_desc, j]
  - file:   [parse, bea_detail.csv]
    from:   [bea_code, bea_desc]
    to:     bea_windc
    input:  [input_bea, input_desc]
    output: i
  - file:   [parse, units.csv]
    from:   from
    to:     [to, factor, units_factor]
    input:  units
    output: [units, factor, units_factor]

Replace:
  col:  value
  from: missing
  to:   0

Operate:
  operation: "*"
  axis:   2
  from:   units
  to:     units_factor
  input:  [value, factor]
  output: value
