# Autogenerated from generate_yaml.xlsx
# !!!! missing AND 0 values. Should we drop missing or make 0?
Editable: true

Path: [.., data, datasources, BEA_2007_2012]

PathOut: [.., data, output, bea_use_det.csv]

XLSXInput:
  name:  Use_SUT_Framework_2007_2012_DET.xlsx
  range: A6:PL420
  sheet:      [2007, 2012]
  descriptor: [2007, 2012]

Describe:
  col: year

Order:
  - {col: year,             type: Int}
  - {col: input_bea_code,   type: String}
  - {col: input_bea_windc,  type: String}
  - {col: output_bea_code,  type: String}
  - {col: output_bea_windc, type: String}
  - {col: units,            type: String}
  - {col: value,            type: Int}

Rename:
  - {from: Code,                  to: input_bea_code}
  - {from: Commodity Description, to: input_bea_desc}

Melt:
  on:  [input_bea_code, input_bea_desc]
  var: output_bea_code
  val: value

Add:
  col: units
  val: millions of us dollars (USD)

Map:
  - file:   [parse, bea_detail.csv]
    from:   bea_code
    to:     [bea_desc, bea_windc]
    input:  output_bea_code
    output: [output_bea_desc, output_bea_windc]
  - file:   [parse, bea_detail.csv]
    from:   [bea_code, bea_desc]
    to:     bea_windc
    input:  [input_bea_code, input_bea_desc]
    output: input_bea_windc

Replace:
  col:  value
  from: missing
  to:   0
