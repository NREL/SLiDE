# Autogenerated from generate_yaml.xlsx
Editable: true

Path: [.., data, datasources, SGF]

PathOut: [.., data, output, sgf_1998.csv]

XLSXInput:
  name:  98states.xlsx
  sheet: 98STABS
  range: A4:AZ56
  descriptor: 1998

Describe:
  col: year

Order:
  - {col: year,      type: Int}
  - {col: state,     type: String}
  - {col: sgf_desc,  type: String}
  - {col: sgf_code,  type: String}
  - {col: windc_code,type: String}
  - {col: units,     type: String}
  - {col: value,     type: Float64}
  - {col: units_0,    type: String}
  - {col: value_0,    type: Any}
  - {col: factor,     type: Any}

Rename:
  - {from: missing, to: sgf_desc}

Melt:
  on:  sgf_desc
  var: state
  val: value

Map:
  - file:   [parse, sgf.csv]
    from:   from
    to:     [sgf_desc, sgf_code, windc_code, units]
    input:  sgf_desc
    output: [sgf_desc, sgf_code, windc_code, units]
  - file:   [parse, regions.csv]
    from:   from
    to:     to
    input:  state
    output: state
  - file:   [parse, units.csv]
    from:   from
    to:     [to, factor, units_factor]
    input:  units
    output: [units, factor, units_factor]

Replace:
  col:  value
  from: missing
  to:   0

Drop:
  - col: missing
    val: missing
    operation: "=="
# - col: sgf_code
#   val: missing
#   operation: "=="

Operate:
  operation: "*"
  from:   units
  to:     units_factor
  input:  [value, factor]
  output: value
