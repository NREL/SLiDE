# Autogenerated from generate_yaml.xlsx
Editable: true

Path: [.., data, datasources, SGF]

PathOut: [.., data, output, sgf_2014-2016.csv]

CSVInput:
  - {name: SGF_2014_00A1.csv, descriptor: 2014}
  - {name: SGF_2015_00A1.csv, descriptor: 2015}
  - {name: SGF_2016_00A1.csv, descriptor: 2016}

Order:
  - {col: yr,        type: Int}
  - {col: r,         type: String}
# - {col: ec_desc,   type: String}
  - {col: ec,        type: String}
# - {col: windc_code,type: String}
  - {col: units,     type: String}
  - {col: value,     type: Float64}
# - {col: units_0, type: String}
# - {col: value_0, type: Any}
# - {col: factor,  type: Any}

Rename:
  - {from: GEO.display-label,     to: r}
  - {from: YEAR.id,               to: yr}
  - {from: FINSRC.id,             to: ec_desc}
  - {from: AMOUNT,                to: value}
  - {from: FINTYPE.id,            to: fintype_code}
  - {from: FINTYPE.display-label, to: fintype_desc}

Map:
  - file:   [parse, sgf.csv]
    from:   from
    to:     [sgf_desc, sgf_code, units]
    input:  ec_desc
    output: [ec_desc, ec, units]
  - file:   [parse, regions.csv]
    from:   from
    to:     to
    input:  r
    output: r
  - file:   [parse, units.csv]
    from:   from
    to:     [to, factor, units_factor]
    input:  units
    output: [units, factor, units_factor]

Replace:
  col:  value
  from: missing
  to:   0

Drop:
  - col: [GEO.id, GEO.id2, GEO.annotation.id]
    val: all
    operation: "=="
# !!!! Dropping DIREXP for now. Does not appear to be used in the buildstream and it maps to multiple input SGF descriptors.
  - col: ec
    val: [missing, DIREXP]
    operation: "=="

Operate:
  operation: "*"
  axis:   col
  from:   units
  to:     units_factor
  input:  [value, factor]
  output: value
